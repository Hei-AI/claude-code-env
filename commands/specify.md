听取需求，然后通过浏览代码库和询问细节来完善需求，形成一份需求文档。

# 工作流

在用户提出功能目标后，应该立即使用 TodoWrite 工具来创建一个新的 todo 列表，严格按顺序执行下面的需求分析流程。todo 列表的各项如下：

1. 代码库探索，理解项目结构和技术栈
2. 与用户讨论需求，确认需求总体目标
3. 编写临时需求文档

## 代码库探索阶段

在开始需求讨论之前，首先需要对代码库进行**有针对性的**探索，重点关注与用户需求可能相关的部分：

1. **需求相关代码探索**
    - 搜索与用户需求关键词相关的文件和代码
    - 深入分析并理解与需求相关的模块和组件
    - 查看相关的配置文件和依赖，了解必要的技术栈信息
2. **相关文档梳理**
   - 查阅与需求相关的项目文档和 README 部分
   - 检查 `/docs/knowledge` 目录中与需求相关的知识图谱文档
   - 查看 `/docs/references.md` 中可能用到的外部参考资源
3. **相关代码规范识别**
    - 分析需求相关模块的代码风格和约定
    - 识别相关组件使用的框架和库
    - 了解相关部分的测试和构建方式
4. **关键组件定位**
    - 重点识别与用户需求直接相关的核心模块和组件
    - 理解相关部分的数据流和业务逻辑
    - 标记需要修改或扩展的具体部分

## 需求讨论阶段

用户提出初始想法后，Claude 通过若干轮问答来帮助用户梳理需求。每轮问答中，应该只提一个问题。如果可能列举选项，应该让用户做选择题。在这个阶段中，尽量不涉及技术实现问题，只涉及功能目标。

## 需求文档生成阶段

若干轮问答后，生成一个总结性的临时需求文档，这个文档应覆盖整个对话所确定的内容。然后，请求用户验收。用户在这时可以选择验收，也可以提出对文档的修正意见。agent根据修正意见进行修正文后，重新请求用户验收。如此反复，直到用户同意验收。
    - 使用项目根目录 `/docs/scratches/` 存放临时需求文档
    - 格式：`{name}.md`，其中 `{name}` 应该使用中文描述
    - 需求文档内容需包含功能目标、技术方案和子任务拆解。如果可能，应该提出多个技术方案，以便用户选择
    - 通过多轮对话，确保需求文档内容准确、详细

注意，严格遵循「避免过度设计」原则：
    - 只实现用户明确要求的功能，不要添加额外特性
    - 优先简单直接的解决方案，避免复杂的架构
    - 不要预先实现「可能会用到」的功能
